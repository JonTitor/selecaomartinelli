{{template "header" .}}

<div id="atividade-editar"
  data-atividade="{{toJson .Atividade.ParaAPI}}"
  data-atividade-tipos="{{toJson .AtividadeTipos.ParaAPI}}">
  <h2 class="titulo">Editar Atividade</h2>

  <form method="POST" action="/atividades/update/">
    <div class="row">
      <div class="col">
        <div class="form-group row">
          <label class="form-control-label col is-right">Tipo de Atividade</label>
          <div class="col">
            <select class="form-control" v-model="atividade.codatt" name="codatt" required @change="atualizaPikaday">
              <option value="">Selecione um tipo de atividade</option>
              <option v-for="tipo in tipos" :value="tipo.codatt">${ tipo.desatt }</option>
            </select>
          </div>
        </div>

        <div v-if="ehTempo">
          <div class="form-inline margin-b-sm">
            <label class="col-4">Data Início</label>
            <label class="col-4">Data Fim</label>
            <label class="col-3">Tempo</label>
          </div>

          <div v-for="(hora, i) in atividade.atividade_horas" class="form-inline margin-b-sm">
            <div class="col-4">
              <input name="datini" v-model.lazy='hora.datini' class="form-control pikaday-atividade" data-time-label="Hora:" required data-fechar-ao-selecionar-hora />
            </div>
            <div class="col-4">
              <input name="datfim" v-model.lazy='hora.datfim' class="form-control pikaday-atividade" data-time-label="Hora:" required data-fechar-ao-selecionar-hora />
            </div>
            <div class="col-3">
              <input :value='diffHora(hora.datini, hora.datfim)' class="form-control" readonly />
            </div>
            <button class="btn btn-danger col-1" @click.prevent="deletarHora(i)">
              <i class="fa fa-minus"></i>
            </button>
          </div>

          <div class="form-inline row justify-content-between margin-b-sm">
            <label class="col-8 is-right">Tempo Total:</label>

            <input class="form-control col-3" :value="diffHoraTotal" readonly />

            <button class="btn btn-success col-1" @click.prevent="addHora">
              <i class="fa fa-plus"></i>
            </button>
          </div>
        </div>

        <div v-if="ehDistancia">
          <div class="form-inline margin-b-sm">
            <label class="col-4">Data Início</label>
            <label class="col-4">Data Fim</label>
            <label class="col-3">Distância (KM)</label>
          </div>

          <div v-for="(quantidade, i) in atividade.atividade_quantidades" class="row form-inline margin-b-sm">
            <div class="col-4">
              <input name="datini" v-model.lazy='quantidade.datini' class="form-control pikaday-atividade" data-time-label="Hora:" required data-fechar-ao-selecionar-hora />
            </div>
            <div class="col-4">
              <input name="datfim" v-model.lazy='quantidade.datfim' class="form-control pikaday-atividade" data-time-label="Hora:" required data-fechar-ao-selecionar-hora />
            </div>
            <div class="col-3">
              <input type="number" name="qtdatv" v-model="quantidade.qtdatv" class="form-control" />
            </div>
            <button class="btn btn-danger col-1" @click.prevent="deletarQuantidade(i)">
              <i class="fa fa-minus"></i>
            </button>
          </div>

          <div class="row justify-content-end">
            <div class="col-1">
              <button class="btn btn-success" @click.prevent="addQuantidade">
                <i class="fa fa-plus"></i>
              </button>
            </div>
          </div>
        </div>

        <div v-if="ehValor" class="row justify-content-center">
          <div class="form-group col-6">
            <label>Valor:</label>

            <div class="input-group">
              <div class="input-group-addon">R$</div>
              <input type="number" class="form-control" name="vlratv" v-model="atividade.vlratv" required />
            </div>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="form-group">
          <label class="form-control-label col-12">Descrição:</label>
          <div class="col-12">
            <textarea class="form-control" name="desatv" rows="10" required>{{.Atividade.DesAtv}}</textarea>
          </div>
        </div>
      </div>
    </div>

    <div class="form-group">
      {{.CSRFInput}}

      <input type="hidden" name="codatv" :value="atividade.codatv" />

      <button class="btn btn-success">
        Atualizar
      </button>
    </div>
  </form>
</div>

{{template "footer" .}}
